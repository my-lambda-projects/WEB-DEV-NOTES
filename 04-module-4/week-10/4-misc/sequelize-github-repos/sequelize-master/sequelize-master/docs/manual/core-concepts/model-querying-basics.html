<h1 id="model-querying---basics">Model Querying - Basics</h1>
<p>Sequelize provides various methods to assist querying your database for data.</p>
<p><em>Important notice: to perform production-ready queries with Sequelize, make sure you have read the <a href="transactions.html">Transactions guide</a> as well. Transactions are important to ensure data integrity and to provide other benefits.</em></p>
<p>This guide will show how to make the standard <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> queries.</p>
<h2 id="simple-insert-queries">Simple INSERT queries</h2>
<p>First, a simple example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="co">// Create a new user</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">const</span> jane <span class="op">=</span> <span class="cf">await</span> <span class="va">User</span>.<span class="at">create</span>(<span class="op">{</span> <span class="dt">firstName</span><span class="op">:</span> <span class="st">&quot;Jane&quot;</span><span class="op">,</span> <span class="dt">lastName</span><span class="op">:</span> <span class="st">&quot;Doe&quot;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Jane&#39;s auto-generated ID:&quot;</span><span class="op">,</span> <span class="va">jane</span>.<span class="at">id</span>)<span class="op">;</span></a></code></pre></div>
<p>The <a href="../class/lib/model.js~Model.html#static-method-create"><code>Model.create()</code></a> method is a shorthand for building an unsaved instance with <a href="../class/lib/model.js~Model.html#static-method-build"><code>Model.build()</code></a> and saving the instance with <a href="../class/lib/model.js~Model.html#instance-method-save"><code>instance.save()</code></a>.</p>
<p>It is also possible to define which attributes can be set in the <code>create</code> method. This can be especially useful if you create database entries based on a form which can be filled by a user. Using that would, for example, allow you to restrict the <code>User</code> model to set only an username and an address but not an admin flag:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">const</span> user <span class="op">=</span> <span class="cf">await</span> <span class="va">User</span>.<span class="at">create</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="dt">username</span><span class="op">:</span> <span class="st">&#39;alice123&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="dt">isAdmin</span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="op">},</span> <span class="op">{</span> <span class="dt">fields</span><span class="op">:</span> [<span class="st">&#39;username&#39;</span>] <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">// let&#39;s assume the default of isAdmin is false</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="va">console</span>.<span class="at">log</span>(<span class="va">user</span>.<span class="at">username</span>)<span class="op">;</span> <span class="co">// &#39;alice123&#39;</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="va">console</span>.<span class="at">log</span>(<span class="va">user</span>.<span class="at">isAdmin</span>)<span class="op">;</span> <span class="co">// false</span></a></code></pre></div>
<h2 id="simple-select-queries">Simple SELECT queries</h2>
<p>You can read the whole table from the database with the <a href="../class/lib/model.js~Model.html#static-method-findAll"><code>findAll</code></a> method:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="co">// Find all users</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">const</span> users <span class="op">=</span> <span class="cf">await</span> <span class="va">User</span>.<span class="at">findAll</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="va">console</span>.<span class="at">log</span>(<span class="va">users</span>.<span class="at">every</span>(user <span class="kw">=&gt;</span> user <span class="kw">instanceof</span> User))<span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;All users:&quot;</span><span class="op">,</span> <span class="va">JSON</span>.<span class="at">stringify</span>(users<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="dv">2</span>))<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> <span class="op">..</span>.</a></code></pre></div>
<h2 id="specifying-attributes-for-select-queries">Specifying attributes for SELECT queries</h2>
<p>To select only some attributes, you can use the <code>attributes</code> option:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="va">Model</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="dt">attributes</span><span class="op">:</span> [<span class="st">&#39;foo&#39;</span><span class="op">,</span> <span class="st">&#39;bar&#39;</span>]</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">SELECT</span> foo, bar <span class="kw">FROM</span> <span class="op">..</span>.</a></code></pre></div>
<p>Attributes can be renamed using a nested array:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="va">Model</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="dt">attributes</span><span class="op">:</span> [<span class="st">&#39;foo&#39;</span><span class="op">,</span> [<span class="st">&#39;bar&#39;</span><span class="op">,</span> <span class="st">&#39;baz&#39;</span>]<span class="op">,</span> <span class="st">&#39;qux&#39;</span>]</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">SELECT</span> foo, bar <span class="kw">AS</span> baz, qux <span class="kw">FROM</span> <span class="op">..</span>.</a></code></pre></div>
<p>You can use <a href="../class/lib/sequelize.js~Sequelize.html#static-method-fn"><code>sequelize.fn</code></a> to do aggregations:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="va">Model</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="dt">attributes</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb9-3" title="3">    <span class="st">&#39;foo&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb9-4" title="4">    [<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;COUNT&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;hats&#39;</span>))<span class="op">,</span> <span class="st">&#39;n_hats&#39;</span>]</a>
<a class="sourceLine" id="cb9-5" title="5">    <span class="st">&#39;bar&#39;</span></a>
<a class="sourceLine" id="cb9-6" title="6">  ]</a>
<a class="sourceLine" id="cb9-7" title="7"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">SELECT</span> foo, <span class="fu">COUNT</span>(hats) <span class="kw">AS</span> n_hats, bar <span class="kw">FROM</span> <span class="op">..</span>.</a></code></pre></div>
<p>When using aggregation function, you must give it an alias to be able to access it from the model. In the example above you can get the number of hats with <code>instance.n_hats</code>.</p>
<p>Sometimes it may be tiresome to list all the attributes of the model if you only want to add an aggregation:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="co">// This is a tiresome way of getting the number of hats (along with every column)</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="va">Model</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="dt">attributes</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb11-4" title="4">    <span class="st">&#39;id&#39;</span><span class="op">,</span> <span class="st">&#39;foo&#39;</span><span class="op">,</span> <span class="st">&#39;bar&#39;</span><span class="op">,</span> <span class="st">&#39;baz&#39;</span><span class="op">,</span> <span class="st">&#39;qux&#39;</span><span class="op">,</span> <span class="st">&#39;hats&#39;</span><span class="op">,</span> <span class="co">// We had to list all attributes...</span></a>
<a class="sourceLine" id="cb11-5" title="5">    [<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;COUNT&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;hats&#39;</span>))<span class="op">,</span> <span class="st">&#39;n_hats&#39;</span>] <span class="co">// To add the aggregation...</span></a>
<a class="sourceLine" id="cb11-6" title="6">  ]</a>
<a class="sourceLine" id="cb11-7" title="7"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-8" title="8"></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">// This is shorter, and less error prone because it still works if you add / remove attributes from your model later</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="va">Model</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb11-11" title="11">  <span class="dt">attributes</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb11-12" title="12">    <span class="dt">include</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb11-13" title="13">      [<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;COUNT&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;hats&#39;</span>))<span class="op">,</span> <span class="st">&#39;n_hats&#39;</span>]</a>
<a class="sourceLine" id="cb11-14" title="14">    ]</a>
<a class="sourceLine" id="cb11-15" title="15">  <span class="op">}</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">SELECT</span> <span class="kw">id</span>, foo, bar, baz, qux, hats, <span class="fu">COUNT</span>(hats) <span class="kw">AS</span> n_hats <span class="kw">FROM</span> <span class="op">..</span>.</a></code></pre></div>
<p>Similarly, itâ€™s also possible to remove a selected few attributes:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="va">Model</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="dt">attributes</span><span class="op">:</span> <span class="op">{</span> <span class="dt">exclude</span><span class="op">:</span> [<span class="st">&#39;baz&#39;</span>] <span class="op">}</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb14-1" title="1"><span class="co">-- Assuming all columns are &#39;id&#39;, &#39;foo&#39;, &#39;bar&#39;, &#39;baz&#39; and &#39;qux&#39;</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">SELECT</span> <span class="kw">id</span>, foo, bar, qux <span class="kw">FROM</span> <span class="op">..</span>.</a></code></pre></div>
<h2 id="applying-where-clauses">Applying WHERE clauses</h2>
<p>The <code>where</code> option is used to filter the query. There are lots of operators to use for the <code>where</code> clause, available as Symbols from <a href="../variable/index.html#static-variable-Op"><code>Op</code></a>.</p>
<h3 id="the-basics">The basics</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="va">Post</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-3" title="3">    <span class="dt">authorId</span><span class="op">:</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb15-4" title="4">  <span class="op">}</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">// SELECT * FROM post WHERE authorId = 2</span></a></code></pre></div>
<p>Observe that no operator (from <code>Op</code>) was explicitly passed, so Sequelize assumed an equality comparison by default. The above code is equivalent to:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">const</span> <span class="op">{</span> Op <span class="op">}</span> <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;sequelize&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="va">Post</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb16-3" title="3">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-4" title="4">    <span class="dt">authorId</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-5" title="5">      [<span class="va">Op</span>.<span class="at">eq</span>]<span class="op">:</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb16-6" title="6">    <span class="op">}</span></a>
<a class="sourceLine" id="cb16-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">// SELECT * FROM post WHERE authorId = 2</span></a></code></pre></div>
<p>Multiple checks can be passed:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="va">Post</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb17-2" title="2">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb17-3" title="3">    <span class="dt">authorId</span><span class="op">:</span> <span class="dv">12</span></a>
<a class="sourceLine" id="cb17-4" title="4">    <span class="dt">status</span><span class="op">:</span> <span class="st">&#39;active&#39;</span></a>
<a class="sourceLine" id="cb17-5" title="5">  <span class="op">}</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">// SELECT * FROM post WHERE authorId = 12 AND status = &#39;active&#39;;</span></a></code></pre></div>
<p>Just like Sequelize inferred the <code>Op.eq</code> operator in the first example, here Sequelize inferred that the caller wanted an <code>AND</code> for the two checks. The code above is equivalent to:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">const</span> <span class="op">{</span> Op <span class="op">}</span> <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;sequelize&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="va">Post</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb18-3" title="3">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-4" title="4">    [<span class="va">Op</span>.<span class="at">and</span>]<span class="op">:</span> [</a>
<a class="sourceLine" id="cb18-5" title="5">      <span class="op">{</span> <span class="dt">authorId</span><span class="op">:</span> <span class="dv">12</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb18-6" title="6">      <span class="op">{</span> <span class="dt">status</span><span class="op">:</span> <span class="st">&#39;active&#39;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb18-7" title="7">    ]</a>
<a class="sourceLine" id="cb18-8" title="8">  <span class="op">}</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co">// SELECT * FROM post WHERE authorId = 12 AND status = &#39;active&#39;;</span></a></code></pre></div>
<p>An <code>OR</code> can be easily performed in a similar way:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">const</span> <span class="op">{</span> Op <span class="op">}</span> <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;sequelize&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="va">Post</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb19-3" title="3">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb19-4" title="4">    [<span class="va">Op</span>.<span class="at">or</span>]<span class="op">:</span> [</a>
<a class="sourceLine" id="cb19-5" title="5">      <span class="op">{</span> <span class="dt">authorId</span><span class="op">:</span> <span class="dv">12</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb19-6" title="6">      <span class="op">{</span> <span class="dt">authorId</span><span class="op">:</span> <span class="dv">13</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb19-7" title="7">    ]</a>
<a class="sourceLine" id="cb19-8" title="8">  <span class="op">}</span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="co">// SELECT * FROM post WHERE authorId = 12 OR authorId = 13;</span></a></code></pre></div>
<p>Since the above was an <code>OR</code> involving the same field, Sequelize allows you to use a slightly different structure which is more readable and generates the same behavior:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">const</span> <span class="op">{</span> Op <span class="op">}</span> <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;sequelize&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="va">Post</span>.<span class="at">destroy</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb20-3" title="3">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb20-4" title="4">    <span class="dt">authorId</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb20-5" title="5">      [<span class="va">Op</span>.<span class="at">or</span>]<span class="op">:</span> [<span class="dv">12</span><span class="op">,</span> <span class="dv">13</span>]</a>
<a class="sourceLine" id="cb20-6" title="6">    <span class="op">}</span></a>
<a class="sourceLine" id="cb20-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="co">// DELETE FROM post WHERE authorId = 12 OR authorId = 13;</span></a></code></pre></div>
<h3 id="operators">Operators</h3>
<p>Sequelize provides several operators.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">const</span> <span class="op">{</span> Op <span class="op">}</span> <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;sequelize&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="va">Post</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb21-3" title="3">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb21-4" title="4">    [<span class="va">Op</span>.<span class="at">and</span>]<span class="op">:</span> [<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="dv">5</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="dv">6</span> <span class="op">}</span>]<span class="op">,</span>            <span class="co">// (a = 5) AND (b = 6)</span></a>
<a class="sourceLine" id="cb21-5" title="5">    [<span class="va">Op</span>.<span class="at">or</span>]<span class="op">:</span> [<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="dv">5</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="dv">6</span> <span class="op">}</span>]<span class="op">,</span>             <span class="co">// (a = 5) OR (b = 6)</span></a>
<a class="sourceLine" id="cb21-6" title="6">    <span class="dt">someAttribute</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb21-7" title="7">      <span class="co">// Basics</span></a>
<a class="sourceLine" id="cb21-8" title="8">      [<span class="va">Op</span>.<span class="at">eq</span>]<span class="op">:</span> <span class="dv">3</span><span class="op">,</span>                              <span class="co">// = 3</span></a>
<a class="sourceLine" id="cb21-9" title="9">      [<span class="va">Op</span>.<span class="at">ne</span>]<span class="op">:</span> <span class="dv">20</span><span class="op">,</span>                             <span class="co">// != 20</span></a>
<a class="sourceLine" id="cb21-10" title="10">      [<span class="va">Op</span>.<span class="at">is</span>]<span class="op">:</span> <span class="kw">null</span><span class="op">,</span>                           <span class="co">// IS NULL</span></a>
<a class="sourceLine" id="cb21-11" title="11">      [<span class="va">Op</span>.<span class="at">not</span>]<span class="op">:</span> <span class="kw">true</span><span class="op">,</span>                          <span class="co">// IS NOT TRUE</span></a>
<a class="sourceLine" id="cb21-12" title="12">      [<span class="va">Op</span>.<span class="at">or</span>]<span class="op">:</span> [<span class="dv">5</span><span class="op">,</span> <span class="dv">6</span>]<span class="op">,</span>                         <span class="co">// (someAttribute = 5) OR (someAttribute = 6)</span></a>
<a class="sourceLine" id="cb21-13" title="13"></a>
<a class="sourceLine" id="cb21-14" title="14">      <span class="co">// Using dialect specific column identifiers (PG in the following example):</span></a>
<a class="sourceLine" id="cb21-15" title="15">      [<span class="va">Op</span>.<span class="at">col</span>]<span class="op">:</span> <span class="st">&#39;user.organization_id&#39;</span><span class="op">,</span>        <span class="co">// = &quot;user&quot;.&quot;organization_id&quot;</span></a>
<a class="sourceLine" id="cb21-16" title="16"></a>
<a class="sourceLine" id="cb21-17" title="17">      <span class="co">// Number comparisons</span></a>
<a class="sourceLine" id="cb21-18" title="18">      [<span class="va">Op</span>.<span class="at">gt</span>]<span class="op">:</span> <span class="dv">6</span><span class="op">,</span>                              <span class="co">// &gt; 6</span></a>
<a class="sourceLine" id="cb21-19" title="19">      [<span class="va">Op</span>.<span class="at">gte</span>]<span class="op">:</span> <span class="dv">6</span><span class="op">,</span>                             <span class="co">// &gt;= 6</span></a>
<a class="sourceLine" id="cb21-20" title="20">      [<span class="va">Op</span>.<span class="at">lt</span>]<span class="op">:</span> <span class="dv">10</span><span class="op">,</span>                             <span class="co">// &lt; 10</span></a>
<a class="sourceLine" id="cb21-21" title="21">      [<span class="va">Op</span>.<span class="at">lte</span>]<span class="op">:</span> <span class="dv">10</span><span class="op">,</span>                            <span class="co">// &lt;= 10</span></a>
<a class="sourceLine" id="cb21-22" title="22">      [<span class="va">Op</span>.<span class="at">between</span>]<span class="op">:</span> [<span class="dv">6</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span>                   <span class="co">// BETWEEN 6 AND 10</span></a>
<a class="sourceLine" id="cb21-23" title="23">      [<span class="va">Op</span>.<span class="at">notBetween</span>]<span class="op">:</span> [<span class="dv">11</span><span class="op">,</span> <span class="dv">15</span>]<span class="op">,</span>               <span class="co">// NOT BETWEEN 11 AND 15</span></a>
<a class="sourceLine" id="cb21-24" title="24"></a>
<a class="sourceLine" id="cb21-25" title="25">      <span class="co">// Other operators</span></a>
<a class="sourceLine" id="cb21-26" title="26"></a>
<a class="sourceLine" id="cb21-27" title="27">      [<span class="va">Op</span>.<span class="at">all</span>]<span class="op">:</span> <span class="va">sequelize</span>.<span class="at">literal</span>(<span class="st">&#39;SELECT 1&#39;</span>)<span class="op">,</span> <span class="co">// &gt; ALL (SELECT 1)</span></a>
<a class="sourceLine" id="cb21-28" title="28"></a>
<a class="sourceLine" id="cb21-29" title="29">      [<span class="va">Op</span>.<span class="at">in</span>]<span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span>                         <span class="co">// IN [1, 2]</span></a>
<a class="sourceLine" id="cb21-30" title="30">      [<span class="va">Op</span>.<span class="at">notIn</span>]<span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span>                      <span class="co">// NOT IN [1, 2]</span></a>
<a class="sourceLine" id="cb21-31" title="31"></a>
<a class="sourceLine" id="cb21-32" title="32">      [<span class="va">Op</span>.<span class="at">like</span>]<span class="op">:</span> <span class="st">&#39;%hat&#39;</span><span class="op">,</span>                       <span class="co">// LIKE &#39;%hat&#39;</span></a>
<a class="sourceLine" id="cb21-33" title="33">      [<span class="va">Op</span>.<span class="at">notLike</span>]<span class="op">:</span> <span class="st">&#39;%hat&#39;</span><span class="op">,</span>                    <span class="co">// NOT LIKE &#39;%hat&#39;</span></a>
<a class="sourceLine" id="cb21-34" title="34">      [<span class="va">Op</span>.<span class="at">startsWith</span>]<span class="op">:</span> <span class="st">&#39;hat&#39;</span><span class="op">,</span>                  <span class="co">// LIKE &#39;hat%&#39;</span></a>
<a class="sourceLine" id="cb21-35" title="35">      [<span class="va">Op</span>.<span class="at">endsWith</span>]<span class="op">:</span> <span class="st">&#39;hat&#39;</span><span class="op">,</span>                    <span class="co">// LIKE &#39;%hat&#39;</span></a>
<a class="sourceLine" id="cb21-36" title="36">      [<span class="va">Op</span>.<span class="at">substring</span>]<span class="op">:</span> <span class="st">&#39;hat&#39;</span><span class="op">,</span>                   <span class="co">// LIKE &#39;%hat%&#39;</span></a>
<a class="sourceLine" id="cb21-37" title="37">      [<span class="va">Op</span>.<span class="at">iLike</span>]<span class="op">:</span> <span class="st">&#39;%hat&#39;</span><span class="op">,</span>                      <span class="co">// ILIKE &#39;%hat&#39; (case insensitive) (PG only)</span></a>
<a class="sourceLine" id="cb21-38" title="38">      [<span class="va">Op</span>.<span class="at">notILike</span>]<span class="op">:</span> <span class="st">&#39;%hat&#39;</span><span class="op">,</span>                   <span class="co">// NOT ILIKE &#39;%hat&#39;  (PG only)</span></a>
<a class="sourceLine" id="cb21-39" title="39">      [<span class="va">Op</span>.<span class="at">regexp</span>]<span class="op">:</span> <span class="st">&#39;^[h|a|t]&#39;</span><span class="op">,</span>                 <span class="co">// REGEXP/~ &#39;^[h|a|t]&#39; (MySQL/PG only)</span></a>
<a class="sourceLine" id="cb21-40" title="40">      [<span class="va">Op</span>.<span class="at">notRegexp</span>]<span class="op">:</span> <span class="st">&#39;^[h|a|t]&#39;</span><span class="op">,</span>              <span class="co">// NOT REGEXP/!~ &#39;^[h|a|t]&#39; (MySQL/PG only)</span></a>
<a class="sourceLine" id="cb21-41" title="41">      [<span class="va">Op</span>.<span class="at">iRegexp</span>]<span class="op">:</span> <span class="st">&#39;^[h|a|t]&#39;</span><span class="op">,</span>                <span class="co">// ~* &#39;^[h|a|t]&#39; (PG only)</span></a>
<a class="sourceLine" id="cb21-42" title="42">      [<span class="va">Op</span>.<span class="at">notIRegexp</span>]<span class="op">:</span> <span class="st">&#39;^[h|a|t]&#39;</span><span class="op">,</span>             <span class="co">// !~* &#39;^[h|a|t]&#39; (PG only)</span></a>
<a class="sourceLine" id="cb21-43" title="43"></a>
<a class="sourceLine" id="cb21-44" title="44">      [<span class="va">Op</span>.<span class="at">any</span>]<span class="op">:</span> [<span class="dv">2</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">,</span>                        <span class="co">// ANY ARRAY[2, 3]::INTEGER (PG only)</span></a>
<a class="sourceLine" id="cb21-45" title="45"></a>
<a class="sourceLine" id="cb21-46" title="46">      <span class="co">// In Postgres, Op.like/Op.iLike/Op.notLike can be combined to Op.any:</span></a>
<a class="sourceLine" id="cb21-47" title="47">      [<span class="va">Op</span>.<span class="at">like</span>]<span class="op">:</span> <span class="op">{</span> [<span class="va">Op</span>.<span class="at">any</span>]<span class="op">:</span> [<span class="st">&#39;cat&#39;</span><span class="op">,</span> <span class="st">&#39;hat&#39;</span>] <span class="op">}</span>  <span class="co">// LIKE ANY ARRAY[&#39;cat&#39;, &#39;hat&#39;]</span></a>
<a class="sourceLine" id="cb21-48" title="48"></a>
<a class="sourceLine" id="cb21-49" title="49">      <span class="co">// There are more postgres-only range operators, see below</span></a>
<a class="sourceLine" id="cb21-50" title="50">    <span class="op">}</span></a>
<a class="sourceLine" id="cb21-51" title="51">  <span class="op">}</span></a>
<a class="sourceLine" id="cb21-52" title="52"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h4 id="shorthand-syntax-for-op.in">Shorthand syntax for <code>Op.in</code></h4>
<p>Passing an array directly to the <code>where</code> option will implicitly use the <code>IN</code> operator:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="va">Post</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb22-2" title="2">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb22-3" title="3">    <span class="dt">id</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span>] <span class="co">// Same as using `id: { [Op.in]: [1,2,3] }`</span></a>
<a class="sourceLine" id="cb22-4" title="4">  <span class="op">}</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co">// SELECT ... FROM &quot;posts&quot; AS &quot;post&quot; WHERE &quot;post&quot;.&quot;id&quot; IN (1, 2, 3);</span></a></code></pre></div>
<h3 id="logical-combinations-with-operators">Logical combinations with operators</h3>
<p>The operators <code>Op.and</code>, <code>Op.or</code> and <code>Op.not</code> can be used to create arbitrarily complex nested logical comparisons.</p>
<h4 id="examples-with-op.and-and-op.or">Examples with <code>Op.and</code> and <code>Op.or</code></h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">const</span> <span class="op">{</span> Op <span class="op">}</span> <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;sequelize&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb23-2" title="2"></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="va">Foo</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb23-4" title="4">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-5" title="5">    <span class="dt">rank</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-6" title="6">      [<span class="va">Op</span>.<span class="at">or</span>]<span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-7" title="7">        [<span class="va">Op</span>.<span class="at">lt</span>]<span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></a>
<a class="sourceLine" id="cb23-8" title="8">        [<span class="va">Op</span>.<span class="at">eq</span>]<span class="op">:</span> <span class="kw">null</span></a>
<a class="sourceLine" id="cb23-9" title="9">      <span class="op">}</span></a>
<a class="sourceLine" id="cb23-10" title="10">    <span class="op">},</span></a>
<a class="sourceLine" id="cb23-11" title="11">    <span class="co">// rank &lt; 1000 OR rank IS NULL</span></a>
<a class="sourceLine" id="cb23-12" title="12"></a>
<a class="sourceLine" id="cb23-13" title="13">    <span class="op">{</span></a>
<a class="sourceLine" id="cb23-14" title="14">      <span class="dt">createdAt</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-15" title="15">        [<span class="va">Op</span>.<span class="at">lt</span>]<span class="op">:</span> <span class="kw">new</span> <span class="at">Date</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb23-16" title="16">        [<span class="va">Op</span>.<span class="at">gt</span>]<span class="op">:</span> <span class="kw">new</span> <span class="at">Date</span>(<span class="kw">new</span> <span class="at">Date</span>() <span class="op">-</span> <span class="dv">24</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb23-17" title="17">      <span class="op">}</span></a>
<a class="sourceLine" id="cb23-18" title="18">    <span class="op">},</span></a>
<a class="sourceLine" id="cb23-19" title="19">    <span class="co">// createdAt &lt; [timestamp] AND createdAt &gt; [timestamp]</span></a>
<a class="sourceLine" id="cb23-20" title="20"></a>
<a class="sourceLine" id="cb23-21" title="21">    <span class="op">{</span></a>
<a class="sourceLine" id="cb23-22" title="22">      [<span class="va">Op</span>.<span class="at">or</span>]<span class="op">:</span> [</a>
<a class="sourceLine" id="cb23-23" title="23">        <span class="op">{</span></a>
<a class="sourceLine" id="cb23-24" title="24">          <span class="dt">title</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-25" title="25">            [<span class="va">Op</span>.<span class="at">like</span>]<span class="op">:</span> <span class="st">&#39;Boat%&#39;</span></a>
<a class="sourceLine" id="cb23-26" title="26">          <span class="op">}</span></a>
<a class="sourceLine" id="cb23-27" title="27">        <span class="op">},</span></a>
<a class="sourceLine" id="cb23-28" title="28">        <span class="op">{</span></a>
<a class="sourceLine" id="cb23-29" title="29">          <span class="dt">description</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-30" title="30">            [<span class="va">Op</span>.<span class="at">like</span>]<span class="op">:</span> <span class="st">&#39;%boat%&#39;</span></a>
<a class="sourceLine" id="cb23-31" title="31">          <span class="op">}</span></a>
<a class="sourceLine" id="cb23-32" title="32">        <span class="op">}</span></a>
<a class="sourceLine" id="cb23-33" title="33">      ]</a>
<a class="sourceLine" id="cb23-34" title="34">    <span class="op">}</span></a>
<a class="sourceLine" id="cb23-35" title="35">    <span class="co">// title LIKE &#39;Boat%&#39; OR description LIKE &#39;%boat%&#39;</span></a>
<a class="sourceLine" id="cb23-36" title="36">  <span class="op">}</span></a>
<a class="sourceLine" id="cb23-37" title="37"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h4 id="examples-with-op.not">Examples with <code>Op.not</code></h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb24-1" title="1"><span class="va">Project</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb24-2" title="2">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-3" title="3">    <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Some Project&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb24-4" title="4">    [<span class="va">Op</span>.<span class="at">not</span>]<span class="op">:</span> [</a>
<a class="sourceLine" id="cb24-5" title="5">      <span class="op">{</span> <span class="dt">id</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span>] <span class="op">},</span></a>
<a class="sourceLine" id="cb24-6" title="6">      <span class="op">{</span></a>
<a class="sourceLine" id="cb24-7" title="7">        <span class="dt">description</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-8" title="8">          [<span class="va">Op</span>.<span class="at">like</span>]<span class="op">:</span> <span class="st">&#39;Hello%&#39;</span></a>
<a class="sourceLine" id="cb24-9" title="9">        <span class="op">}</span></a>
<a class="sourceLine" id="cb24-10" title="10">      <span class="op">}</span></a>
<a class="sourceLine" id="cb24-11" title="11">    ]</a>
<a class="sourceLine" id="cb24-12" title="12">  <span class="op">}</span></a>
<a class="sourceLine" id="cb24-13" title="13"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>The above will generate:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">SELECT</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">FROM</span> `Projects`</a>
<a class="sourceLine" id="cb25-3" title="3"><span class="kw">WHERE</span> (</a>
<a class="sourceLine" id="cb25-4" title="4">  `Projects`.`name` <span class="op">=</span> <span class="st">&#39;a project&#39;</span></a>
<a class="sourceLine" id="cb25-5" title="5">  <span class="kw">AND</span> <span class="kw">NOT</span> (</a>
<a class="sourceLine" id="cb25-6" title="6">    `Projects`.`id` <span class="kw">IN</span> (<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb25-7" title="7">    <span class="kw">OR</span></a>
<a class="sourceLine" id="cb25-8" title="8">    `Projects`.`description` <span class="kw">LIKE</span> <span class="st">&#39;Hello%&#39;</span></a>
<a class="sourceLine" id="cb25-9" title="9">  )</a>
<a class="sourceLine" id="cb25-10" title="10">)</a></code></pre></div>
<h3 id="advanced-queries-with-functions-not-just-columns">Advanced queries with functions (not just columns)</h3>
<p>What if you wanted to obtain something like <code>WHERE char_length("content") = 7</code>?</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb26-1" title="1"><span class="va">Post</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb26-2" title="2">  <span class="dt">where</span><span class="op">:</span> <span class="va">sequelize</span>.<span class="at">where</span>(<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;char_length&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;content&#39;</span>))<span class="op">,</span> <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb26-3" title="3"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co">// SELECT ... FROM &quot;posts&quot; AS &quot;post&quot; WHERE char_length(&quot;content&quot;) = 7</span></a></code></pre></div>
<p>Note the usage of the <a href="../class/lib/sequelize.js~Sequelize.html#static-method-fn"><code>sequelize.fn</code></a> and <a href="../class/lib/sequelize.js~Sequelize.html#static-method-col"><code>sequelize.col</code></a> methods, which should be used to specify an SQL function call and a table column, respectively. These methods should be used instead of passing a plain string (such as <code>char_length(content)</code>) because Sequelize needs to treat this situation differently (for example, using other symbol escaping approaches).</p>
<p>What if you need something even more complex?</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb27-1" title="1"><span class="va">Post</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb27-2" title="2">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb27-3" title="3">    [<span class="va">Op</span>.<span class="at">or</span>]<span class="op">:</span> [</a>
<a class="sourceLine" id="cb27-4" title="4">      <span class="va">sequelize</span>.<span class="at">where</span>(<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;char_length&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;content&#39;</span>))<span class="op">,</span> <span class="dv">7</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb27-5" title="5">      <span class="op">{</span></a>
<a class="sourceLine" id="cb27-6" title="6">        <span class="dt">content</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb27-7" title="7">          [<span class="va">Op</span>.<span class="at">like</span>]<span class="op">:</span> <span class="st">&#39;Hello%&#39;</span></a>
<a class="sourceLine" id="cb27-8" title="8">        <span class="op">}</span></a>
<a class="sourceLine" id="cb27-9" title="9">      <span class="op">},</span></a>
<a class="sourceLine" id="cb27-10" title="10">      <span class="op">{</span></a>
<a class="sourceLine" id="cb27-11" title="11">        [<span class="va">Op</span>.<span class="at">and</span>]<span class="op">:</span> [</a>
<a class="sourceLine" id="cb27-12" title="12">          <span class="op">{</span> <span class="dt">status</span><span class="op">:</span> <span class="st">&#39;draft&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb27-13" title="13">          <span class="va">sequelize</span>.<span class="at">where</span>(<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;char_length&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;content&#39;</span>))<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb27-14" title="14">            [<span class="va">Op</span>.<span class="at">gt</span>]<span class="op">:</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb27-15" title="15">          <span class="op">}</span>)</a>
<a class="sourceLine" id="cb27-16" title="16">        ]</a>
<a class="sourceLine" id="cb27-17" title="17">      <span class="op">}</span></a>
<a class="sourceLine" id="cb27-18" title="18">    ]</a>
<a class="sourceLine" id="cb27-19" title="19">  <span class="op">}</span></a>
<a class="sourceLine" id="cb27-20" title="20"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>The above generates the following SQL:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">SELECT</span></a>
<a class="sourceLine" id="cb28-2" title="2">  <span class="op">..</span>.</a>
<a class="sourceLine" id="cb28-3" title="3"><span class="kw">FROM</span> <span class="ot">&quot;posts&quot;</span> <span class="kw">AS</span> <span class="ot">&quot;post&quot;</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="kw">WHERE</span> (</a>
<a class="sourceLine" id="cb28-5" title="5">  char_length(<span class="ot">&quot;content&quot;</span>) <span class="op">=</span> <span class="dv">7</span></a>
<a class="sourceLine" id="cb28-6" title="6">  <span class="kw">OR</span></a>
<a class="sourceLine" id="cb28-7" title="7">  <span class="ot">&quot;post&quot;</span>.<span class="ot">&quot;content&quot;</span> <span class="kw">LIKE</span> <span class="st">&#39;Hello%&#39;</span></a>
<a class="sourceLine" id="cb28-8" title="8">  <span class="kw">OR</span> (</a>
<a class="sourceLine" id="cb28-9" title="9">    <span class="ot">&quot;post&quot;</span>.<span class="ot">&quot;status&quot;</span> <span class="op">=</span> <span class="st">&#39;draft&#39;</span></a>
<a class="sourceLine" id="cb28-10" title="10">    <span class="kw">AND</span></a>
<a class="sourceLine" id="cb28-11" title="11">    char_length(<span class="ot">&quot;content&quot;</span>) <span class="op">&gt;</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb28-12" title="12">  )</a>
<a class="sourceLine" id="cb28-13" title="13">)</a></code></pre></div>
<h3 id="postgres-only-range-operators">Postgres-only Range Operators</h3>
<p>Range types can be queried with all supported operators.</p>
<p>Keep in mind, the provided range value can <a href="data-types.html#range-types">define the bound inclusion/exclusion</a> as well.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb29-1" title="1">[<span class="va">Op</span>.<span class="at">contains</span>]<span class="op">:</span> <span class="dv">2</span><span class="op">,</span>            <span class="co">// @&gt; &#39;2&#39;::integer  (PG range contains element operator)</span></a>
<a class="sourceLine" id="cb29-2" title="2">[<span class="va">Op</span>.<span class="at">contains</span>]<span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span>       <span class="co">// @&gt; [1, 2)        (PG range contains range operator)</span></a>
<a class="sourceLine" id="cb29-3" title="3">[<span class="va">Op</span>.<span class="at">contained</span>]<span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span>      <span class="co">// &lt;@ [1, 2)        (PG range is contained by operator)</span></a>
<a class="sourceLine" id="cb29-4" title="4">[<span class="va">Op</span>.<span class="at">overlap</span>]<span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span>        <span class="co">// &amp;&amp; [1, 2)        (PG range overlap (have points in common) operator)</span></a>
<a class="sourceLine" id="cb29-5" title="5">[<span class="va">Op</span>.<span class="at">adjacent</span>]<span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span>       <span class="co">// -|- [1, 2)       (PG range is adjacent to operator)</span></a>
<a class="sourceLine" id="cb29-6" title="6">[<span class="va">Op</span>.<span class="at">strictLeft</span>]<span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span>     <span class="co">// &lt;&lt; [1, 2)        (PG range strictly left of operator)</span></a>
<a class="sourceLine" id="cb29-7" title="7">[<span class="va">Op</span>.<span class="at">strictRight</span>]<span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span>    <span class="co">// &gt;&gt; [1, 2)        (PG range strictly right of operator)</span></a>
<a class="sourceLine" id="cb29-8" title="8">[<span class="va">Op</span>.<span class="at">noExtendRight</span>]<span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span>  <span class="co">// &amp;&lt; [1, 2)        (PG range does not extend to the right of operator)</span></a>
<a class="sourceLine" id="cb29-9" title="9">[<span class="va">Op</span>.<span class="at">noExtendLeft</span>]<span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span>   <span class="co">// &amp;&gt; [1, 2)        (PG range does not extend to the left of operator)</span></a></code></pre></div>
<h3 id="deprecated-operator-aliases">Deprecated: Operator Aliases</h3>
<p>In Sequelize v4, it was possible to specify strings to refer to operators, instead of using Symbols. This is now deprecated and heavily discouraged, and will probably be removed in the next major version. If you really need it, you can pass the <code>operatorAliases</code> option in the Sequelize constructor.</p>
<p>For example:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">const</span> <span class="op">{</span> Sequelize<span class="op">,</span> Op <span class="op">}</span> <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;sequelize&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw">const</span> sequelize <span class="op">=</span> <span class="kw">new</span> <span class="at">Sequelize</span>(<span class="st">&#39;sqlite::memory:&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb30-3" title="3">  <span class="dt">operatorsAliases</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb30-4" title="4">    <span class="dt">$gt</span><span class="op">:</span> <span class="va">Op</span>.<span class="at">gt</span></a>
<a class="sourceLine" id="cb30-5" title="5">  <span class="op">}</span></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb30-7" title="7"></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="co">// Now we can use `$gt` instead of `[Op.gt]` in where clauses:</span></a>
<a class="sourceLine" id="cb30-9" title="9"><span class="va">Foo</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb30-10" title="10">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb30-11" title="11">    <span class="dt">$gt</span><span class="op">:</span> <span class="dv">6</span> <span class="co">// Works like using [Op.gt]</span></a>
<a class="sourceLine" id="cb30-12" title="12">  <span class="op">}</span></a>
<a class="sourceLine" id="cb30-13" title="13"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="simple-update-queries">Simple UPDATE queries</h2>
<p>Update queries also accept the <code>where</code> option, just like the read queries shown above.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb31-1" title="1"><span class="co">// Change everyone without a last name to &quot;Doe&quot;</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="cf">await</span> <span class="va">User</span>.<span class="at">update</span>(<span class="op">{</span> <span class="dt">lastName</span><span class="op">:</span> <span class="st">&quot;Doe&quot;</span> <span class="op">},</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb31-3" title="3">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb31-4" title="4">    <span class="dt">lastName</span><span class="op">:</span> <span class="kw">null</span></a>
<a class="sourceLine" id="cb31-5" title="5">  <span class="op">}</span></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="simple-delete-queries">Simple DELETE queries</h2>
<p>Delete queries also accept the <code>where</code> option, just like the read queries shown above.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb32-1" title="1"><span class="co">// Delete everyone named &quot;Jane&quot;</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="cf">await</span> <span class="va">User</span>.<span class="at">destroy</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb32-3" title="3">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb32-4" title="4">    <span class="dt">firstName</span><span class="op">:</span> <span class="st">&quot;Jane&quot;</span></a>
<a class="sourceLine" id="cb32-5" title="5">  <span class="op">}</span></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>To destroy everything the <code>TRUNCATE</code> SQL can be used:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb33-1" title="1"><span class="co">// Truncate the table</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="cf">await</span> <span class="va">User</span>.<span class="at">destroy</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb33-3" title="3">  <span class="dt">truncate</span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="creating-in-bulk">Creating in bulk</h2>
<p>Sequelize provides the <code>Model.bulkCreate</code> method to allow creating multiple records at once, with only one query.</p>
<p>The usage of <code>Model.bulkCreate</code> is very similar to <code>Model.create</code>, by receiving an array of objects instead of a single object.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">const</span> captains <span class="op">=</span> <span class="cf">await</span> <span class="va">Captain</span>.<span class="at">bulkCreate</span>([</a>
<a class="sourceLine" id="cb34-2" title="2">  <span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Jack Sparrow&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb34-3" title="3">  <span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Davy Jones&#39;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb34-4" title="4">])<span class="op">;</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="va">console</span>.<span class="at">log</span>(<span class="va">captains</span>.<span class="at">length</span>)<span class="op">;</span> <span class="co">// 2</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="va">console</span>.<span class="at">log</span>(captains[<span class="dv">0</span>] <span class="kw">instanceof</span> Captain)<span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="va">console</span>.<span class="at">log</span>(captains[<span class="dv">0</span>].<span class="at">name</span>)<span class="op">;</span> <span class="co">// &#39;Jack Sparrow&#39;</span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="va">console</span>.<span class="at">log</span>(captains[<span class="dv">0</span>].<span class="at">id</span>)<span class="op">;</span> <span class="co">// 1 // (or another auto-generated value)</span></a></code></pre></div>
<p>However, by default, <code>bulkCreate</code> does not run validations on each object that is going to be created (which <code>create</code> does). To make <code>bulkCreate</code> run these validations as well, you must pass the <code>validate: true</code> option. This will decrease performance. Usage example:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">const</span> Foo <span class="op">=</span> <span class="va">sequelize</span>.<span class="at">define</span>(<span class="st">&#39;foo&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb35-2" title="2">  <span class="dt">bar</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb35-3" title="3">    <span class="dt">type</span><span class="op">:</span> <span class="va">DataTypes</span>.<span class="at">TEXT</span><span class="op">,</span></a>
<a class="sourceLine" id="cb35-4" title="4">    <span class="dt">validate</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb35-5" title="5">      <span class="dt">len</span><span class="op">:</span> [<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>]</a>
<a class="sourceLine" id="cb35-6" title="6">    <span class="op">}</span></a>
<a class="sourceLine" id="cb35-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb35-9" title="9"></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="co">// This will not throw an error, both instances will be created</span></a>
<a class="sourceLine" id="cb35-11" title="11"><span class="cf">await</span> <span class="va">Foo</span>.<span class="at">bulkCreate</span>([</a>
<a class="sourceLine" id="cb35-12" title="12">  <span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;abc123&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb35-13" title="13">  <span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;name too long&#39;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb35-14" title="14">])<span class="op">;</span></a>
<a class="sourceLine" id="cb35-15" title="15"></a>
<a class="sourceLine" id="cb35-16" title="16"><span class="co">// This will throw an error, nothing will be created</span></a>
<a class="sourceLine" id="cb35-17" title="17"><span class="cf">await</span> <span class="va">Foo</span>.<span class="at">bulkCreate</span>([</a>
<a class="sourceLine" id="cb35-18" title="18">  <span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;abc123&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb35-19" title="19">  <span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;name too long&#39;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb35-20" title="20">]<span class="op">,</span> <span class="op">{</span> <span class="dt">validate</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>If you are accepting values directly from the user, it might be beneficial to limit the columns that you want to actually insert. To support this, <code>bulkCreate()</code> accepts a <code>fields</code> option, an array defining which fields must be considered (the rest will be ignored).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb36-1" title="1"><span class="cf">await</span> <span class="va">User</span>.<span class="at">bulkCreate</span>([</a>
<a class="sourceLine" id="cb36-2" title="2">  <span class="op">{</span> <span class="dt">username</span><span class="op">:</span> <span class="st">&#39;foo&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb36-3" title="3">  <span class="op">{</span> <span class="dt">username</span><span class="op">:</span> <span class="st">&#39;bar&#39;</span><span class="op">,</span> <span class="dt">admin</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb36-4" title="4">]<span class="op">,</span> <span class="op">{</span> <span class="dt">fields</span><span class="op">:</span> [<span class="st">&#39;username&#39;</span>] <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="co">// Neither foo nor bar are admins.</span></a></code></pre></div>
<h2 id="ordering-and-grouping">Ordering and Grouping</h2>
<p>Sequelize provides the <code>order</code> and <code>group</code> options to work with <code>ORDER BY</code> and <code>GROUP BY</code>.</p>
<h3 id="ordering">Ordering</h3>
<p>The <code>order</code> option takes an array of items to order the query by or a sequelize method. These <em>items</em> are themselves arrays in the form <code>[column, direction]</code>. The column will be escaped correctly and the direction will be checked in a whitelist of valid directions (such as <code>ASC</code>, <code>DESC</code>, <code>NULLS FIRST</code>, etc).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb37-1" title="1"><span class="va">Subtask</span>.<span class="at">findAll</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb37-2" title="2">  <span class="dt">order</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb37-3" title="3">    <span class="co">// Will escape title and validate DESC against a list of valid direction parameters</span></a>
<a class="sourceLine" id="cb37-4" title="4">    [<span class="st">&#39;title&#39;</span><span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-5" title="5"></a>
<a class="sourceLine" id="cb37-6" title="6">    <span class="co">// Will order by max(age)</span></a>
<a class="sourceLine" id="cb37-7" title="7">    <span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;age&#39;</span>))<span class="op">,</span></a>
<a class="sourceLine" id="cb37-8" title="8"></a>
<a class="sourceLine" id="cb37-9" title="9">    <span class="co">// Will order by max(age) DESC</span></a>
<a class="sourceLine" id="cb37-10" title="10">    [<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;age&#39;</span>))<span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-11" title="11"></a>
<a class="sourceLine" id="cb37-12" title="12">    <span class="co">// Will order by  otherfunction(`col1`, 12, &#39;lalala&#39;) DESC</span></a>
<a class="sourceLine" id="cb37-13" title="13">    [<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;otherfunction&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;col1&#39;</span>)<span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="st">&#39;lalala&#39;</span>)<span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-14" title="14"></a>
<a class="sourceLine" id="cb37-15" title="15">    <span class="co">// Will order an associated model&#39;s createdAt using the model name as the association&#39;s name.</span></a>
<a class="sourceLine" id="cb37-16" title="16">    [Task<span class="op">,</span> <span class="st">&#39;createdAt&#39;</span><span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-17" title="17"></a>
<a class="sourceLine" id="cb37-18" title="18">    <span class="co">// Will order through an associated model&#39;s createdAt using the model names as the associations&#39; names.</span></a>
<a class="sourceLine" id="cb37-19" title="19">    [Task<span class="op">,</span> Project<span class="op">,</span> <span class="st">&#39;createdAt&#39;</span><span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-20" title="20"></a>
<a class="sourceLine" id="cb37-21" title="21">    <span class="co">// Will order by an associated model&#39;s createdAt using the name of the association.</span></a>
<a class="sourceLine" id="cb37-22" title="22">    [<span class="st">&#39;Task&#39;</span><span class="op">,</span> <span class="st">&#39;createdAt&#39;</span><span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-23" title="23"></a>
<a class="sourceLine" id="cb37-24" title="24">    <span class="co">// Will order by a nested associated model&#39;s createdAt using the names of the associations.</span></a>
<a class="sourceLine" id="cb37-25" title="25">    [<span class="st">&#39;Task&#39;</span><span class="op">,</span> <span class="st">&#39;Project&#39;</span><span class="op">,</span> <span class="st">&#39;createdAt&#39;</span><span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-26" title="26"></a>
<a class="sourceLine" id="cb37-27" title="27">    <span class="co">// Will order by an associated model&#39;s createdAt using an association object. (preferred method)</span></a>
<a class="sourceLine" id="cb37-28" title="28">    [<span class="va">Subtask</span>.<span class="va">associations</span>.<span class="at">Task</span><span class="op">,</span> <span class="st">&#39;createdAt&#39;</span><span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-29" title="29"></a>
<a class="sourceLine" id="cb37-30" title="30">    <span class="co">// Will order by a nested associated model&#39;s createdAt using association objects. (preferred method)</span></a>
<a class="sourceLine" id="cb37-31" title="31">    [<span class="va">Subtask</span>.<span class="va">associations</span>.<span class="at">Task</span><span class="op">,</span> <span class="va">Task</span>.<span class="va">associations</span>.<span class="at">Project</span><span class="op">,</span> <span class="st">&#39;createdAt&#39;</span><span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-32" title="32"></a>
<a class="sourceLine" id="cb37-33" title="33">    <span class="co">// Will order by an associated model&#39;s createdAt using a simple association object.</span></a>
<a class="sourceLine" id="cb37-34" title="34">    [<span class="op">{</span><span class="dt">model</span><span class="op">:</span> Task<span class="op">,</span> <span class="dt">as</span><span class="op">:</span> <span class="st">&#39;Task&#39;</span><span class="op">},</span> <span class="st">&#39;createdAt&#39;</span><span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-35" title="35"></a>
<a class="sourceLine" id="cb37-36" title="36">    <span class="co">// Will order by a nested associated model&#39;s createdAt simple association objects.</span></a>
<a class="sourceLine" id="cb37-37" title="37">    [<span class="op">{</span><span class="dt">model</span><span class="op">:</span> Task<span class="op">,</span> <span class="dt">as</span><span class="op">:</span> <span class="st">&#39;Task&#39;</span><span class="op">},</span> <span class="op">{</span><span class="dt">model</span><span class="op">:</span> Project<span class="op">,</span> <span class="dt">as</span><span class="op">:</span> <span class="st">&#39;Project&#39;</span><span class="op">},</span> <span class="st">&#39;createdAt&#39;</span><span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]</a>
<a class="sourceLine" id="cb37-38" title="38">  ]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-39" title="39"></a>
<a class="sourceLine" id="cb37-40" title="40">  <span class="co">// Will order by max age descending</span></a>
<a class="sourceLine" id="cb37-41" title="41">  <span class="dt">order</span><span class="op">:</span> <span class="va">sequelize</span>.<span class="at">literal</span>(<span class="st">&#39;max(age) DESC&#39;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb37-42" title="42"></a>
<a class="sourceLine" id="cb37-43" title="43">  <span class="co">// Will order by max age ascending assuming ascending is the default order when direction is omitted</span></a>
<a class="sourceLine" id="cb37-44" title="44">  <span class="dt">order</span><span class="op">:</span> <span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;age&#39;</span>))<span class="op">,</span></a>
<a class="sourceLine" id="cb37-45" title="45"></a>
<a class="sourceLine" id="cb37-46" title="46">  <span class="co">// Will order by age ascending assuming ascending is the default order when direction is omitted</span></a>
<a class="sourceLine" id="cb37-47" title="47">  <span class="dt">order</span><span class="op">:</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;age&#39;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb37-48" title="48"></a>
<a class="sourceLine" id="cb37-49" title="49">  <span class="co">// Will order randomly based on the dialect (instead of fn(&#39;RAND&#39;) or fn(&#39;RANDOM&#39;))</span></a>
<a class="sourceLine" id="cb37-50" title="50">  <span class="dt">order</span><span class="op">:</span> <span class="va">sequelize</span>.<span class="at">random</span>()</a>
<a class="sourceLine" id="cb37-51" title="51"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb37-52" title="52"></a>
<a class="sourceLine" id="cb37-53" title="53"><span class="va">Foo</span>.<span class="at">findOne</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb37-54" title="54">  <span class="dt">order</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb37-55" title="55">    <span class="co">// will return `name`</span></a>
<a class="sourceLine" id="cb37-56" title="56">    [<span class="st">&#39;name&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-57" title="57">    <span class="co">// will return `username` DESC</span></a>
<a class="sourceLine" id="cb37-58" title="58">    [<span class="st">&#39;username&#39;</span><span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-59" title="59">    <span class="co">// will return max(`age`)</span></a>
<a class="sourceLine" id="cb37-60" title="60">    <span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;age&#39;</span>))<span class="op">,</span></a>
<a class="sourceLine" id="cb37-61" title="61">    <span class="co">// will return max(`age`) DESC</span></a>
<a class="sourceLine" id="cb37-62" title="62">    [<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;max&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;age&#39;</span>))<span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-63" title="63">    <span class="co">// will return otherfunction(`col1`, 12, &#39;lalala&#39;) DESC</span></a>
<a class="sourceLine" id="cb37-64" title="64">    [<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;otherfunction&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;col1&#39;</span>)<span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="st">&#39;lalala&#39;</span>)<span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb37-65" title="65">    <span class="co">// will return otherfunction(awesomefunction(`col`)) DESC, This nesting is potentially infinite!</span></a>
<a class="sourceLine" id="cb37-66" title="66">    [<span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;otherfunction&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">fn</span>(<span class="st">&#39;awesomefunction&#39;</span><span class="op">,</span> <span class="va">sequelize</span>.<span class="at">col</span>(<span class="st">&#39;col&#39;</span>)))<span class="op">,</span> <span class="st">&#39;DESC&#39;</span>]</a>
<a class="sourceLine" id="cb37-67" title="67">  ]</a>
<a class="sourceLine" id="cb37-68" title="68"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>To recap, the elements of the order array can be the following:</p>
<ul>
<li>A string (which will be automatically quoted)</li>
<li>An array, whose first element will be quoted, second will be appended verbatim</li>
<li>An object with a <code>raw</code> field:
<ul>
<li>The content of <code>raw</code> will be added verbatim without quoting</li>
<li>Everything else is ignored, and if raw is not set, the query will fail</li>
</ul></li>
<li>A call to <code>Sequelize.fn</code> (which will generate a function call in SQL)</li>
<li>A call to <code>Sequelize.col</code> (which will quoute the column name)</li>
</ul>
<h3 id="grouping">Grouping</h3>
<p>The syntax for grouping and ordering are equal, except that grouping does not accept a direction as last argument of the array (there is no <code>ASC</code>, <code>DESC</code>, <code>NULLS FIRST</code>, etc).</p>
<p>You can also pass a string directly to <code>group</code>, which will be included directly (verbatim) into the generated SQL. Use with caution and donâ€™t use with user generated content.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb38-1" title="1"><span class="va">Project</span>.<span class="at">findAll</span>(<span class="op">{</span> <span class="dt">group</span><span class="op">:</span> <span class="st">&#39;name&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="co">// yields &#39;GROUP BY name&#39;</span></a></code></pre></div>
<h2 id="limits-and-pagination">Limits and Pagination</h2>
<p>The <code>limit</code> and <code>offset</code> options allow you to work with limiting / pagination:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb39-1" title="1"><span class="co">// Fetch 10 instances/rows</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="va">Project</span>.<span class="at">findAll</span>(<span class="op">{</span> <span class="dt">limit</span><span class="op">:</span> <span class="dv">10</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb39-3" title="3"></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="co">// Skip 8 instances/rows</span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="va">Project</span>.<span class="at">findAll</span>(<span class="op">{</span> <span class="dt">offset</span><span class="op">:</span> <span class="dv">8</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb39-6" title="6"></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="co">// Skip 5 instances and fetch the 5 after that</span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="va">Project</span>.<span class="at">findAll</span>(<span class="op">{</span> <span class="dt">offset</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">limit</span><span class="op">:</span> <span class="dv">5</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Usually these are used alongside the <code>order</code> option.</p>
<h2 id="utility-methods">Utility methods</h2>
<p>Sequelize also provides a few utility methods.</p>
<h3 id="count"><code>count</code></h3>
<p>The <code>count</code> method simply counts the occurrences of elements in the database.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb40-1" title="1"><span class="va">console</span>.<span class="at">log</span>(<span class="vs">`There are </span><span class="sc">${</span><span class="cf">await</span> <span class="va">Project</span>.<span class="at">count</span>()<span class="sc">}</span><span class="vs"> projects`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb40-2" title="2"></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="kw">const</span> amount <span class="op">=</span> <span class="cf">await</span> <span class="va">Project</span>.<span class="at">count</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb40-4" title="4">  <span class="dt">where</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb40-5" title="5">    <span class="dt">id</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb40-6" title="6">      [<span class="va">Op</span>.<span class="at">gt</span>]<span class="op">:</span> <span class="dv">25</span></a>
<a class="sourceLine" id="cb40-7" title="7">    <span class="op">}</span></a>
<a class="sourceLine" id="cb40-8" title="8">  <span class="op">}</span></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb40-10" title="10"><span class="va">console</span>.<span class="at">log</span>(<span class="vs">`There are </span><span class="sc">${</span>amount<span class="sc">}</span><span class="vs"> projects with an id greater than 25`</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="max-min-and-sum"><code>max</code>, <code>min</code> and <code>sum</code></h3>
<p>Sequelize also provides the <code>max</code>, <code>min</code> and <code>sum</code> convenience methods.</p>
<p>Letâ€™s assume we have three users, whose ages are 10, 5, and 40.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb41-1" title="1"><span class="cf">await</span> <span class="va">User</span>.<span class="at">max</span>(<span class="st">&#39;age&#39;</span>)<span class="op">;</span> <span class="co">// 40</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="cf">await</span> <span class="va">User</span>.<span class="at">max</span>(<span class="st">&#39;age&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">where</span><span class="op">:</span> <span class="op">{</span> <span class="dt">age</span><span class="op">:</span> <span class="op">{</span> [<span class="va">Op</span>.<span class="at">lt</span>]<span class="op">:</span> <span class="dv">20</span> <span class="op">}</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span> <span class="co">// 10</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="cf">await</span> <span class="va">User</span>.<span class="at">min</span>(<span class="st">&#39;age&#39;</span>)<span class="op">;</span> <span class="co">// 5</span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="cf">await</span> <span class="va">User</span>.<span class="at">min</span>(<span class="st">&#39;age&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">where</span><span class="op">:</span> <span class="op">{</span> <span class="dt">age</span><span class="op">:</span> <span class="op">{</span> [<span class="va">Op</span>.<span class="at">gt</span>]<span class="op">:</span> <span class="dv">5</span> <span class="op">}</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span> <span class="co">// 10</span></a>
<a class="sourceLine" id="cb41-5" title="5"><span class="cf">await</span> <span class="va">User</span>.<span class="at">sum</span>(<span class="st">&#39;age&#39;</span>)<span class="op">;</span> <span class="co">// 55</span></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="cf">await</span> <span class="va">User</span>.<span class="at">sum</span>(<span class="st">&#39;age&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">where</span><span class="op">:</span> <span class="op">{</span> <span class="dt">age</span><span class="op">:</span> <span class="op">{</span> [<span class="va">Op</span>.<span class="at">gt</span>]<span class="op">:</span> <span class="dv">5</span> <span class="op">}</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span> <span class="co">// 50</span></a></code></pre></div>
