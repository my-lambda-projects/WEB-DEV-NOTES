WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.gadgets:macro-browser-for-gadgetsplugin', location = 'script/gadget-macro-browser.js' */
AJS.toInit(function(a){var b={};b.postPreview=function(h,d){var f=h.contentWindow.AJS;var c={};var k=a("#macro-param-div-preferences input").val().split("&");for(var j=0,o=k.length;j<o;j++){var g=k[j].split("=");try{c[decodeURI(g[0])]=decodeURI(g[1])}catch(l){}}if(d.needsConfig&&f){var m=!!c.isConfigured;if(!m){var n=a("#macro-browser-dialog .dialog-button-panel .ok");a("#save-warning-span").addClass("gadget-not-configured-warning").text("Please complete the configuration in the preview area first").removeClass("hidden");n.prop("disabled",true)}}};b.beforeParamsSet=function(j,c){var h=j.preferences;if(!c&&h){var g=h.split("&");for(var d=0,f=g.length;d<f;d++){var e=g[d].split("=");j[decodeURI(e[0])]=decodeURI(e[1])}}return j};b.updateMacroParametersForPreview=function(c){c.forceWrite=true;return c};b.manipulateMarkup=function(f){if(AJS.MacroBrowser.gadgetPrefsChanged){var d=top.document.getElementById("macro-insert-container");var g=a("#macro-param-div-preferences input",d);var c="";for(var e in AJS.MacroBrowser.gadgetPrefs){if(c.length!=0){c+="&"}c=c+encodeURI(e)+"="+encodeURI(AJS.MacroBrowser.gadgetPrefs[e])}g.val(c)}};b.getMacroDetailsFromSelectedMacro=function(f,g){var c=g.params.url;for(var e=0,h=f.length;e<h;e++){var d=f[e];if(d.macroName===g.name&&d.gadgetUrl===c){return d}}};b.beforeParamsRetrieved=function(p,h,j){var s="";if(h.nonHiddenUserPrefs){var m=true;var d={},f=p.preferences;if(f){var n=f.split("&");for(var l=0,q=n.length;l<q;l++){var k=n[l].split("=");var o=decodeURI(k[0]);var r=decodeURI(k[1]);d[o]=r}}for(var e in j){d[e]=j[e]}var c=function(v,t,w){var x=v.formDetails.parameters;for(var u=0;u<x.length;u++){if(x[u].name==t){return w==x[u].defaultValue}}AJS.log("Unable to find matching param for "+t);return false};for(var g in d){if(!c(h,g,d[g])){if(!m){s+="&"}m=false;s=s+encodeURI(g)+"="+encodeURI(d[g])}}p.preferences=s}return p};AJS.MacroBrowser.setMacroJsOverride("gadget",b)});
}catch(e){WRMCB(e)};