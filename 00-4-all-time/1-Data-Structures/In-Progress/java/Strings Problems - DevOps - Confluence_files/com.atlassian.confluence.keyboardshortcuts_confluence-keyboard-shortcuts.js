WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.keyboardshortcuts:confluence-keyboard-shortcuts', location = 'js/confluence-keyboard-shortcuts.js' */
define("confluence-keyboard-shortcuts/confluence-keyboard-shortcuts","ajs jquery confluence-keyboard-shortcuts/confluence-keyboard-shortcuts-soy window confluence/dialog confluence-keyboard-shortcuts/shortcut-dialog-tab-autoformat confluence/dark-features".split(" "),function(a,f,l,d,x,y,v){var c,k={Autoformat:[],Editor:[],enabled:!1,ready:!1,dialog:null,closeDialog:function(){u().then(function(a){a.hide()});return!1},openDialog:function(){f(this).removeClass("interactive");u().then(function(a){a.show()});
return!1}},u=function(){function g(){d.Confluence&&d.Confluence.Editor&&d.Confluence.Editor.isVisible&&d.Confluence.Editor.isVisible()?(c.overrideLastTab(),c.gotoPanel(1)):c.gotoPanel(0)}var h=f.Deferred();if(c)return g(),h.resolve(c);var q=k.shortcuts,m=-1!==d.navigator.platform.indexOf("Mac"),z=function(e){var b=a("span").addClass("item-action");e=e.keys[0];for(var f=0;f<e.length;f++){0<f&&b.append(w("then"));for(var c=b,n=e[f].split("+"),d=0;d<n.length;d++){0<
d&&c.append(w("+"));for(var h=c,p=n[d].split(".."),g=0;g<p.length;g++)0<g&&h.append(w("to")),h.append(u(p[g]))}}return b},u=function(e){var b=a("kbd");switch(e){case "Shift":case "Sh":b.text("Shift");b.addClass("modifier-key");break;case "Ctrl":e=m?"âŒ˜":"Ctrl";b.text(e);b.addClass("modifier-key");break;case "Tab":b.text("Tab");b.addClass("modifier-key");break;case "Alt":b.text("Alt");
b.addClass("modifier-key");break;case "LeftAlt":e=m?"Option":"Left Alt";b.text(e);b.addClass("modifier-key");break;case "Control":b.text("Control");b.addClass("modifier-key");break;case "Option":b.text("Option");b.addClass("modifier-key");break;case "UpArrow":b.text("\u2191");b.addClass("regular-key");break;case "DownArrow":b.text("\u2193");
b.addClass("regular-key");break;case "LeftArrow":b.text("\u2190");b.addClass("regular-key");break;case "RightArrow":b.text("\u2192");b.addClass("regular-key");break;default:b.text(e),b.addClass("regular-key")}return b},w=function(e){var b=a("span");b.text(e);b.addClass("key-separator");return b},r=function(e,b,c){e=f(l.keyboardShortcutModule({title:e}));for(var d=e.find("ul"),n=0;n<c.length;n++){var g=c[n];if(!g.hidden&&
-1!==f.inArray(g.context,b)){var h=a("li").addClass("item-details"),p=g.description,p=a("strong").addClass("item-description").append(p);h.append(p);h.append(z(g));d.append(h)}}return e};c=x.component({width:950,height:660,id:"keyboard-shortcuts-dialog"});c.addHeader("Keyboard Shortcuts");c.addPanel("General",function(){var e=f(l.keyboardShortcutPanel({panelId:"general-shortcuts-panel"})),b=f(e).children(".shortcutsmenu");
a.Meta.get("atlassian-account-id")&&e.find(".keyboard-shortcut-dialog-panel-header").append(l.keyboardShortcutEnabledCheckbox());b.append(r("Global Shortcuts",["global"],q));b.append(r("Page / Blog Post Actions",["viewcontent","viewinfo"],q));return e}());c.addPanel("Editor",function(){var e=f(l.keyboardShortcutPanel({panelId:"editor-shortcuts-panel"})),b=f(e).children(".shortcutsmenu"),
c=["tinymce.block"],g=["tinymce.rich"],d=["tinymce.actions"];v.isEnabled("editor.spa.uxenhancements")&&(e.addClass("foxy-ux-enhancement"),c=["adg3.tinymce.block"],g=["adg3.tinymce.rich"],g.push(m?"adg3.tinymce.rich.mac":"adg3.tinymce.rich.win"),d=["adg3.tinymce.actions"],d.push(m?"adg3.tinymce.actions.mac":"adg3.tinymce.actions.win"));b.append(r("Block Formatting",c,q));b.append(r("Rich Formatting",g,q));b.append(r("Editing Actions",
d,q));return e}());c.addPanel("Editor Autoformatting",y());c.addCancel("Close",function(){a.debug("Hiding Shortcuts help");c.hide();return!1});c.popup.element.find(".dialog-title").prepend(l.keyboardShortcutHelpLink());a.trigger("keyboard-shortcut-dialog-ready",c);g();h.resolve(c);f("#keyboard-shortcut-enabled-checkbox").prop("checked",t.keyboardShortcuts.enabled).click(function(e){var b=f(this).prop("checked");f.ajax({type:"POST",url:a.contextPath()+
"/rest/confluenceshortcuts/latest/enabled",data:f.toJSON({enabled:b}),dataType:"json",contentType:"application/json"}).done(function(){t.keyboardShortcuts.enabled=b;t.keyboardShortcuts.ready=!1;b?a.trigger("add-bindings.keyboardshortcuts"):a.trigger("remove-bindings.keyboardshortcuts")})});return h},t={init:function(){a.debug("confluence-keyboard-shortcuts initialising");a.PageGadget||d.parent.AJS&&d.parent.AJS.PageGadget?a.debug("Inside the Page Gadget. Skipping keyboard shortcuts"):(k.enabled=a.Meta.getBoolean("use-keyboard-shortcuts"),
a.bind("shortcuts-loaded.keyboardshortcuts",function(a,c){k.shortcuts=c.shortcuts;f("#keyboard-shortcuts-link").click(k.openDialog)}),a.bind("register-contexts.keyboardshortcuts",function(c,h){if(k.enabled){c=h.shortcutRegistry;h=d.Confluence&&d.Confluence.Editor&&d.Confluence.Editor.isVisible&&d.Confluence.Editor.isVisible();f("#action-menu-link").length&&!h&&c.enableContext("viewcontent");f("#viewPageLink").length&&c.enableContext("viewinfo");if(h){v.isEnabled("editor.spa.uxenhancements")?c.enableContext("adg3.tinymce.actions"):
c.enableContext("editor");var g=require("tinymce"),m=g.activeEditor,l=f("#rte").closest("form");f.each(k.shortcuts,function(c,d){if(0===d.context.indexOf("tinymce")){var h=d.op,e=d.param;f.each(d.keys,function(){var b=this,c;"click"==h?c=function(){f(e).click()}:"execute"==h&&(c=e);if(c){f.isArray(b)&&(b=b.join(","));var k=b.toLowerCase(),k=4<=parseInt(g.majorVersion,10)&&g.isMac?k.replace("ctrl","meta"):k;a.debug("Adding shortcut for "+k);m.addShortcut(k,"",c);v.isEnabled("editor.spa.uxenhancements")||
"tinymce.actions"!=d.context||-1===b.indexOf("+")||(a.debug("Binding shortcut on inputs too for "+b),l.delegate(":input","keydown",function(a){var e=a.keyCode?a.keyCode:a.which,d=b.split("+"),d=f.map(d,function(b){return"Ctrl"==b&&a.metaKey||"Shift"==b&&a.shiftKey||e==b.charCodeAt(0)?null:b});d.length||(c(),a.preventDefault())}))}else a.logError("ERROR: unkown editor shortcut key operation "+h+" for shortcut "+b)})}})}k.ready=!0}}),"undefined"!==typeof a.contextPath()&&k.enabled&&(f("#rte").length?
a.bind("init.rte",function(){a.trigger("initialize.keyboardshortcuts")}):a.trigger("initialize.keyboardshortcuts")))}};t.keyboardShortcuts=k;return t});require("confluence/module-exporter").safeRequire("confluence-keyboard-shortcuts/confluence-keyboard-shortcuts",function(a){var f=require("ajs");Confluence.KeyboardShortcuts=a.keyboardShortcuts;f.toInit(a.init)});
}catch(e){WRMCB(e)};